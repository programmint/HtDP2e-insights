学习笔记 / 第5章：添加结构体

<br>

### 5.10、r3 与 R3 区别？

<br>

P105

```
(define-struct r3 [x y z])
; An R3 is a structure:
;   (make-r3 Number Number Number)
 
(define ex1 (make-r3 1 2 13))
(define ex2 (make-r3 -1 0 3))
```

令人备感奇怪，定义了结构体 r3，可是注释却写成了 R3，字母大小写之间有什么差别？

<br>

问了 deepseek ，答复如下：

<br>

**第 1、结构体名称 (r3，小写）**

**语法定义** ：(define-struct r3 [x y z])

这是结构体类型的构造函数名称，遵循 Racket 的命名惯例（通常小写+短横线分隔）。

**用途：** 用于创建具体的结构体实例，例如：

~~~
(make-r3 1 2 3)  ; 构造一个 r3 实例
(r3? some-value) ; 检查是否为 r3 结构体
(r3-x a-point)   ; 访问字段 x
~~~

**本质：** 这是代码中实际操作的“工具名”，与语法直接绑定。

<br>

**第 2. 数据定义名称 (R3，大写）**   

**数据定义注释：**
~~~
; An R3 is a structure:
;   (make-r3 Number Number Number)
~~~
这是程序员自定义的数据类型名称，表示“所有合法的三维点”的集合。它遵循 HTDP 的约定（首字母大写），目的是：

**语义清晰：** 明确这是一个“数据类型”，而不仅仅是一个结构体。

**抽象层级：** 数据定义可能包含更复杂的约束（例如“所有 r3 实例，且其字段均为数字”），而不仅仅是结构体本身的语法定义。

**本质：** 这是程序员对数据的逻辑描述，是设计文档的一部分，而非语法的一部分。

<br>

**为什么不能统一用小写？**  

**技术必要性：**

Racket 语法要求结构体构造函数（如 make-r3）和类型检查（如 r3?）必须用小写命名，这是语言规范。

数据定义（如 R3）是程序员自定义的注释名称，不受语法限制，但需遵循可读性约定。

<br>

**设计意图：**

**区分抽象与实现：**

**r3**（小写）是具体的结构体操作（代码实现）。

**R3**（大写）是抽象的数据类型（设计文档）。

**避免混淆：**

例如，当看到 R3 时，程序员知道它代表逻辑上的“三维点”概念；而 r3 是操作这个概念的语法工具。

<br>

**HTDP 的设计哲学**

HTDP 强调数据定义与代码实现的分离：

**第 1、数据定义**（如 R3）描述“合法数据是什么”。

**第 2、结构体定义**（如 r3）描述“如何构造和操作数据”。

这种分离让程序更易理解和维护。例如，若未来需要扩展 R3（如增加约束条件），只需修改数据定义，而不必重写结构体代码。



